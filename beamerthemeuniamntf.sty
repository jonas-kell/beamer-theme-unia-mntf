% Copyright 2024 by Jonas Kell
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.

\usepackage{graphicx}
\usepackage{tikz}

\newif\ifbeamer@fai
\beamer@faifalse

\DeclareOptionBeamer{fai}{\beamer@faitrue}
\ProcessOptionsBeamer

\mode<presentation>

% ! extend existing stuff

\usetheme{Boadilla} % uses `block` from Boadilla and takes it as a base to overwrite
\ifbeamer@fai\usecolortheme[fai]{uniamntf}\else\usecolortheme{uniamntf}\fi
\usefonttheme{structurebold}
\useinnertheme{rectangles} % replace with more custom stuff
\useoutertheme{infolines}
\setbeamersize{text margin left=4em,text margin right=0em}
\logo{\includegraphics{slide-background-images/logo-small.png}}



% ! first page
\defbeamertemplate*{title page}{uniamntf theme}{
  \hspace*{-6em}\hspace*{.50\paperwidth}\vspace*{-200em}%
  \pgfsetfillopacity{0.90}
  \begin{beamercolorbox}[wd=.47\paperwidth,sep=1.8em,ht=.85\paperheight,left]{section in head/foot}%
      \includegraphics[width=0.4\paperwidth]{slide-background-images/logo-mntf-full}\\
      \makebox{}{}\\
      \makebox{}{}\\
      \makebox{}{}\\
      \usebeamerfont{title}\inserttitle\\
      \usebeamerfont{subtitle}\insertsubtitle\\
      \makebox{}{}\\
      \usebeamerfont{author}\insertauthor\\
      \usebeamerfont{institute}\insertinstitute\\
      \makebox{}{}\\
      \makebox{}{}\\
      \usebeamerfont{date}\insertdate
      \makebox{}{}\\
      \makebox{}{}\\
      \makebox{}{}\\
  \end{beamercolorbox}%
  \pgfsetfillopacity{1}
}
\setbeamertemplate{title page}[uniamntf]

% ! title-redefinition

% Define a command to insert a " - " for separation if needed
\newcount\Level
\let\Part=\part\def\part{\global\Level=0\Part}
\let\Chapter=\chapter\def\chapter{\global\Level=1\Chapter}
\let\Section=\section\def\section{\global\Level=2\Section}
\let\Subsection=\subsection\def\subsection{\global\Level=3\Subsection}
\let\Subsubsection=\subsubsection\def\subsubsection{\global\Level=4\Subsubsection}
\def\subsectionSeparator{
  \ifcase\the\Level % part
  \or % chapter
  \or % section
  \or- % subsection
  \or % subsubsection
  \else  \fi}

% overwrite the frametitle region
\defbeamertemplate*{frametitle}{uniamntf theme}
{%
  \vspace*{0.7em}%
  \begin{tikzpicture}[remember picture,overlay]%
    \fill[structure] (current page.north west) -- ++(0,0) -- ++(0,-0.45\paperheight) -- ++(0.5,0.02\paperheight) -- ++(0,0.43\paperheight) -- cycle;%
  \end{tikzpicture}%
  {\usebeamercolor*{black}\usebeamerfont{frametitle}\usebeamerfont{frametitle in head/foot}\insertframetitle}
  \\
  {\normalsize\vspace*{-0.8em}\begin{beamercolorbox}[wd=.905\paperwidth,sep=0ex,ht=.1ex,left]{separator}\end{beamercolorbox}\vspace*{-0.4em}%
    \usebeamerfont{section}\usebeamerfont{section in head/foot}\usebeamertemplate{section in head/foot}
    \subsectionSeparator{}
    \usebeamerfont{subsection}\usebeamertemplate{subsection in head/foot}\usebeamerfont{subsection in head/foot}}
  \vskip0pt%
}
\setbeamertemplate{frametitle}[uniamntf]
\setbeamertemplate{headline}[default]

% \setbeamertemplate{footline}{%
%         \if\insertframenumber\inserttotalframenumber
%             last frame
%         \else
%             footline of normal slides
%         \fi
% }

\mode
<all>